

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>FFT &amp; Filtering of Atomically Resolved Images &mdash; pycroscopy 0.60.7 documentation</title>
  

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/gallery.css" type="text/css" />
  <link rel="stylesheet" href="../_static/gallery-binder.css" type="text/css" />
  <link rel="stylesheet" href="../_static/gallery-dataframe.css" type="text/css" />
  <link rel="stylesheet" href="../_static/gallery-rendered-html.css" type="text/css" />

  
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    
    <link rel="author" title="About these documents" href="../about.html" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Image alignment and registration" href="plot_image_registration.html" />
    <link rel="prev" title="Examples &amp; Tutorials" href="index.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home"> pycroscopy
          

          
            
            <img src="../_static/logo_v01.png" class="logo" alt="Logo"/>
          
          </a>

          
            
            
              <div class="version">
                0.60.7
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../about.html">Pycroscopy</a></li>
<li class="toctree-l1"><a class="reference internal" href="../papers_conferences.html">Papers / Conferences</a></li>
<li class="toctree-l1"><a class="reference internal" href="../getting_started.html">Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="../install.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../external_guides.html">Tutorials on Basics</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Examples &amp; Tutorials</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="index.html#tutorials-on-fundamental-data-tools">Tutorials on fundamental data tools</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="index.html#scientific-data-analysis">Scientific Data Analysis</a><ul class="current">
<li class="toctree-l3 current"><a class="current reference internal" href="#">FFT &amp; Filtering of Atomically Resolved Images</a></li>
<li class="toctree-l3"><a class="reference internal" href="plot_image_registration.html">Image alignment and registration</a></li>
<li class="toctree-l3"><a class="reference internal" href="plot_spectral_unmixing.html">Spectral Unmixing</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../translators.html">Data Translators</a></li>
<li class="toctree-l1"><a class="reference internal" href="../faq.html">Frequently asked questions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../contribution_guidelines.html">Guidelines for Contribution</a></li>
<li class="toctree-l1"><a class="reference internal" href="../contact.html">Contact us</a></li>
<li class="toctree-l1"><a class="reference internal" href="../whats_new.html">What’s New</a></li>
<li class="toctree-l1"><a class="reference internal" href="../credits.html">Credits</a></li>
<li class="toctree-l1"><a class="reference internal" href="../credits.html#acknowledgements">Acknowledgements</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api.html">API Reference</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">pycroscopy</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="index.html">Examples &amp; Tutorials</a> &raquo;</li>
        
      <li>FFT &amp; Filtering of Atomically Resolved Images</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="../_sources/auto_examples/plot_fft_2d_filtering.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="sphx-glr-download-link-note admonition note">
<p class="admonition-title">Note</p>
<p>Click <a class="reference internal" href="#sphx-glr-download-auto-examples-plot-fft-2d-filtering-py"><span class="std std-ref">here</span></a>
to download the full example code</p>
</div>
<div class="sphx-glr-example-title section" id="fft-filtering-of-atomically-resolved-images">
<span id="sphx-glr-auto-examples-plot-fft-2d-filtering-py"></span><h1>FFT &amp; Filtering of Atomically Resolved Images<a class="headerlink" href="#fft-filtering-of-atomically-resolved-images" title="Permalink to this headline">¶</a></h1>
<p><strong>Stephen Jesse and Suhas Somnath</strong></p>
<ul class="simple">
<li><p>Institute for Functional Imaging of Materials</p></li>
<li><p>Center for Nanophase Materials Sciences</p></li>
</ul>
<p>Oak Ridge National Laboratory, Oak Ridge TN 37831, USA</p>
<p>9/28/2015</p>
<p>Fourier transforms offer a very fast and convenient means to analyze and filter
multidimensional data including images. The power of the Fast Fourier Transform
(FFT) is due in part to (as the name suggests) its speed and also to the fact that
complex operations such as convolution and differentiation/integration are made much
simpler when performed in the Fourier domain. For instance, convolution in the real
space domain can be performed using multiplication in the Fourier domain, and
differentiation/integration in the real space domain can be performed by
multiplying/dividing by iω in the Fourier domain (where ω is the transformed variable).
We will take advantage of these properties and demonstrate simple image filtering and
convolution with example.</p>
<p>A few properties/uses of FFT’s are worth reviewing.</p>
<p>In this example we will load an image, Fourier transform it, apply a smoothing filter, and transform it back.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">__future__</span> <span class="kn">import</span> <span class="n">division</span><span class="p">,</span> <span class="n">unicode_literals</span><span class="p">,</span> <span class="n">print_function</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">h5py</span>
<span class="kn">import</span> <span class="nn">numpy.fft</span> <span class="k">as</span> <span class="nn">npf</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">subprocess</span>
<span class="kn">import</span> <span class="nn">sys</span>


<span class="k">def</span> <span class="nf">install</span><span class="p">(</span><span class="n">package</span><span class="p">):</span>
    <span class="n">subprocess</span><span class="o">.</span><span class="n">call</span><span class="p">([</span><span class="n">sys</span><span class="o">.</span><span class="n">executable</span><span class="p">,</span> <span class="s2">&quot;-m&quot;</span><span class="p">,</span> <span class="s2">&quot;pip&quot;</span><span class="p">,</span> <span class="s2">&quot;install&quot;</span><span class="p">,</span> <span class="n">package</span><span class="p">])</span>


<span class="c1"># for downloading files:</span>
<span class="k">try</span><span class="p">:</span>
    <span class="c1"># This package is not part of anaconda and may need to be installed.</span>
    <span class="kn">import</span> <span class="nn">wget</span>
<span class="k">except</span> <span class="ne">ImportError</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;wget not found.  Will install with pip.&#39;</span><span class="p">)</span>
    <span class="kn">import</span> <span class="nn">pip</span>
    <span class="n">install</span><span class="p">(</span><span class="s1">&#39;wget&#39;</span><span class="p">)</span>
    <span class="kn">import</span> <span class="nn">wget</span>
<span class="k">try</span><span class="p">:</span>
    <span class="kn">import</span> <span class="nn">pyUSID</span> <span class="k">as</span> <span class="nn">usid</span>
<span class="k">except</span> <span class="ne">ImportError</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;pyUSID not found.  Will install with pip.&#39;</span><span class="p">)</span>
    <span class="kn">import</span> <span class="nn">pip</span>
    <span class="n">install</span><span class="p">(</span><span class="s1">&#39;pyUSID&#39;</span><span class="p">)</span>
    <span class="kn">import</span> <span class="nn">pyUSID</span> <span class="k">as</span> <span class="nn">usid</span>
</pre></div>
</div>
<p>We will be using an image available on our GitHub project page by default. You are encouraged
to download this document as a Jupyter Notebook (button at the bottom of the page) and use your own image instead.
When using your own image, you can skip this cell and provide the path to your data as 2D numpy array using the
variable - <code class="docutils literal notranslate"><span class="pre">image_raw</span></code></p>
<p>Coming back to our example, lets start by downloading the file from GitHub:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">h5_path</span> <span class="o">=</span> <span class="s1">&#39;temp.h5&#39;</span>
<span class="c1"># download the data file from Github:</span>
<span class="n">url</span> <span class="o">=</span> <span class="s1">&#39;https://raw.githubusercontent.com/pycroscopy/pycroscopy/master/data/STEM_STO_2_20.h5&#39;</span>
<span class="n">_</span> <span class="o">=</span> <span class="n">wget</span><span class="o">.</span><span class="n">download</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">h5_path</span><span class="p">,</span> <span class="n">bar</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
</pre></div>
</div>
<p>The image is formatting according to the Universal Spectroscopic and Imaing Data (USID) model and is stored in a
Hierarchical Data Format (HDF5) file. To learn more about this standardized file format for imaging and spectroscopic
data, please visit <a class="reference external" href="https://pycroscopy.github.io/USID/about.html">here</a>.
However, data formatting will not be the focus of this example.</p>
<p>Here, we will load the data out of this standardized format and into numpy using a few simple commands found in our
sister software package - <code class="docutils literal notranslate"><span class="pre">pyUSID</span></code>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">h5_f</span> <span class="o">=</span> <span class="n">h5py</span><span class="o">.</span><span class="n">File</span><span class="p">(</span><span class="n">h5_path</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Contents of this h5 file:&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;-------------------------&#39;</span><span class="p">)</span>
<span class="n">usid</span><span class="o">.</span><span class="n">hdf_utils</span><span class="o">.</span><span class="n">print_tree</span><span class="p">(</span><span class="n">h5_f</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;-------------------------&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Some important properties of this data:&#39;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">val</span> <span class="ow">in</span> <span class="n">usid</span><span class="o">.</span><span class="n">hdf_utils</span><span class="o">.</span><span class="n">get_attributes</span><span class="p">(</span><span class="n">h5_f</span><span class="p">[</span><span class="s1">&#39;/Measurement_000&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> : </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">val</span><span class="p">))</span>
</pre></div>
</div>
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>Contents of this h5 file:
-------------------------
/
├ Measurement_000
  ---------------
  ├ Channel_000
    -----------
    ├ Position_Indices
    ├ Position_Values
    ├ Raw_Data
    ├ Spectroscopic_Indices
    ├ Spectroscopic_Values
-------------------------
Some important properties of this data:
/home/travis/virtualenv/python3.6.7/lib/python3.6/site-packages/pyUSID/io/hdf_utils/base.py:133: UserWarning: pyUSID.io.hdf_utils.get_attributes has been moved to sidpy.hdf.hdf_utils.get_attributes. This copy in pyUSID willbe removed in future release. Please update your import statements
  warn(&#39;pyUSID.io.hdf_utils.get_attributes has been moved to &#39;
author : Stephen Jesse
image_type : simulated
instrument_type : STEM
sample_name : STO
</pre></div>
</div>
<p>Access the dataset containing the 2D image of interest, print out its properties and</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">h5_main</span> <span class="o">=</span> <span class="n">usid</span><span class="o">.</span><span class="n">hdf_utils</span><span class="o">.</span><span class="n">get_all_main</span><span class="p">(</span><span class="n">h5_f</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="n">h5_main</span><span class="p">)</span>
</pre></div>
</div>
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>/home/travis/virtualenv/python3.6.7/lib/python3.6/site-packages/pyUSID/io/dtype_utils.py:65: FutureWarning: pyUSID.io.dtype_utils.contains_integers has been moved to sidpy.base.num_utils.contains_integers. This copy in pyUSID willbe removed in future release. Please update your import statements
  FutureWarning)
/home/travis/virtualenv/python3.6.7/lib/python3.6/site-packages/pyUSID/io/dtype_utils.py:41: FutureWarning: pyUSID.io.dtype_utils.lazy_load_array has been moved to sidpy.hdf.hdf_utils.lazy_load_array. This copy in pyUSID willbe removed in future release. Please update your import statements
  FutureWarning)
&lt;HDF5 dataset &quot;Raw_Data&quot;: shape (1048576, 1), type &quot;&lt;f4&quot;&gt;
located at:
        /Measurement_000/Channel_000/Raw_Data
Data contains:
        Intensity (a. u.)
Data dimensions and original shape:
Position Dimensions:
        X - size: 1024
        Y - size: 1024
Spectroscopic Dimensions:
        arb - size: 1
Data Type:
        float32
</pre></div>
</div>
<p>Visualize this dataset using a quick command:
Notice that the X and Y axis have scientific information encoded, as does the color bar</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">axis</span> <span class="o">=</span> <span class="n">h5_main</span><span class="o">.</span><span class="n">visualize</span><span class="p">(</span><span class="n">cmap</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">inferno</span><span class="p">)</span>
<span class="n">axis</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;original image of STO captured via STEM&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
</pre></div>
</div>
<img alt="original image of STO captured via STEM" class="sphx-glr-single-img" src="../_images/sphx_glr_plot_fft_2d_filtering_001.png" />
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>Text(0.5, 1.0, &#39;original image of STO captured via STEM&#39;)
</pre></div>
</div>
<p>get the contents as Numpy array using a single command:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">image_raw</span> <span class="o">=</span> <span class="n">h5_main</span><span class="o">.</span><span class="n">get_n_dim_form</span><span class="p">()</span><span class="o">.</span><span class="n">squeeze</span><span class="p">()</span>
</pre></div>
</div>
<p>Prior to transforming, it is sometimes convenient to set the image mean to zero,
because if the mean value of an image is large, the magnitude of the zero-frequency
bin can dominate over the other signals of interest.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">image_raw</span> <span class="o">=</span> <span class="n">image_raw</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">image_raw</span><span class="p">)</span>  <span class="c1"># subtract out the mean of the image</span>
</pre></div>
</div>
<p>An important aspect of performing Fourier transforms is keeping track of units
between transformations and also being aware of conventions used with regard to
the locations of the image centers and extents when transformed.</p>
<p>We start by extracting the vectors that define the X and Y axis. Unlike conventional text files
or popular image formats, which do not capture this information, the USID model captures all this
scientifically important metadata. Let us visualize this information before extracting it:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">ncols</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
<span class="k">for</span> <span class="n">axis</span><span class="p">,</span> <span class="n">dim_name</span><span class="p">,</span> <span class="n">y_label</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">axes</span><span class="p">,</span> <span class="n">h5_main</span><span class="o">.</span><span class="n">pos_dim_labels</span><span class="p">,</span> <span class="n">h5_main</span><span class="o">.</span><span class="n">pos_dim_descriptors</span><span class="p">):</span>
    <span class="n">axis</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">h5_main</span><span class="o">.</span><span class="n">get_pos_values</span><span class="p">(</span><span class="n">dim_name</span><span class="p">))</span>
    <span class="n">axis</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Position Dimension - &#39;</span> <span class="o">+</span> <span class="n">dim_name</span><span class="p">)</span>
    <span class="n">axis</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="n">y_label</span><span class="p">)</span>
    <span class="n">axis</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Index&#39;</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
</pre></div>
</div>
<img alt="Position Dimension - X, Position Dimension - Y" class="sphx-glr-single-img" src="../_images/sphx_glr_plot_fft_2d_filtering_002.png" />
<p>Now let us access the same axis vectors:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">x_axis_vec</span> <span class="o">=</span> <span class="n">h5_main</span><span class="o">.</span><span class="n">get_pos_values</span><span class="p">(</span><span class="s1">&#39;X&#39;</span><span class="p">)</span>
<span class="n">y_axis_vec</span> <span class="o">=</span> <span class="n">h5_main</span><span class="o">.</span><span class="n">get_pos_values</span><span class="p">(</span><span class="s1">&#39;X&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>Below is code
that builds the axes in the space domain of the original image.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">x_pixels</span><span class="p">,</span> <span class="n">y_pixels</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="n">image_raw</span><span class="p">)</span>  <span class="c1"># [pixels]</span>
<span class="n">x_edge_length</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">x_axis_vec</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="mi">1</span><span class="p">)</span>  <span class="c1"># 5.0 [nm]</span>
<span class="n">y_edge_length</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">y_axis_vec</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="mi">1</span><span class="p">)</span>  <span class="c1"># 5.0 [nm]</span>
<span class="n">x_sampling</span> <span class="o">=</span> <span class="n">x_pixels</span> <span class="o">/</span> <span class="n">x_edge_length</span>  <span class="c1"># [pixels/nm]</span>
<span class="n">y_sampling</span> <span class="o">=</span> <span class="n">y_pixels</span> <span class="o">/</span> <span class="n">y_edge_length</span>  <span class="c1"># [pixels/nm]</span>
<span class="n">x_axis_vec</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="n">x_edge_length</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="n">x_edge_length</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="n">x_pixels</span><span class="p">)</span>  <span class="c1"># vector of locations along x-axis</span>
<span class="n">y_axis_vec</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="n">y_edge_length</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="n">y_edge_length</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="n">y_pixels</span><span class="p">)</span>  <span class="c1"># vector of locations along y-axis</span>
<span class="n">x_mat</span><span class="p">,</span> <span class="n">y_mat</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">x_axis_vec</span><span class="p">,</span> <span class="n">y_axis_vec</span><span class="p">)</span>  <span class="c1"># matrices of x-positions and y-positions</span>
</pre></div>
</div>
<p>Similarly, the axes in the Fourier domain are defined below. Note, that since
the number of pixels along an axis is even, a convention must be followed as to
which side of the halfway point the zero-frequency bin is located. In Matlab, the
zero frequency bin is located to the left of the halfway point. Therefore the axis
extends from -ω_sampling/2 to one frequency bin less than +ω_sampling/2.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">u_max</span> <span class="o">=</span> <span class="n">x_sampling</span> <span class="o">/</span> <span class="mi">2</span>
<span class="n">v_max</span> <span class="o">=</span> <span class="n">y_sampling</span> <span class="o">/</span> <span class="mi">2</span>
<span class="n">u_axis_vec</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="n">u_max</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="n">u_max</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="n">x_pixels</span><span class="p">)</span>
<span class="n">v_axis_vec</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="n">v_max</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="n">v_max</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="n">y_pixels</span><span class="p">)</span>
<span class="n">u_mat</span><span class="p">,</span> <span class="n">v_mat</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">u_axis_vec</span><span class="p">,</span> <span class="n">v_axis_vec</span><span class="p">)</span>  <span class="c1"># matrices of u-positions and v-positions</span>
</pre></div>
</div>
<p>The Fourier transform can be determined with one line of code:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">fft_image_raw</span> <span class="o">=</span> <span class="n">npf</span><span class="o">.</span><span class="n">fft2</span><span class="p">(</span><span class="n">image_raw</span><span class="p">)</span>
</pre></div>
</div>
<p>Plotting the magnitude 2D-FFT on a vertical log scales shows something unexpected:
there appears to be peaks at the corners and no information at the center.
This is because the output for the ‘fft2’ function flips the frequency axes so
that low frequencies are at the ends, and the highest frequency is in the middle.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">axis</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">_</span> <span class="o">=</span> <span class="n">usid</span><span class="o">.</span><span class="n">plot_utils</span><span class="o">.</span><span class="n">plot_map</span><span class="p">(</span><span class="n">axis</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">fft_image_raw</span><span class="p">),</span> <span class="n">cmap</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">OrRd</span><span class="p">,</span> <span class="n">clim</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mf">3E+3</span><span class="p">])</span>
<span class="n">axis</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;FFT2 of image&#39;</span><span class="p">)</span>
</pre></div>
</div>
<img alt="FFT2 of image" class="sphx-glr-single-img" src="../_images/sphx_glr_plot_fft_2d_filtering_003.png" />
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>Text(0.5, 1.0, &#39;FFT2 of image&#39;)
</pre></div>
</div>
<p>To correct this, use the ‘fftshift’ command.
fftshift brings the lowest frequency components of the FFT back to the center of the plot</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">fft_image_raw</span> <span class="o">=</span> <span class="n">npf</span><span class="o">.</span><span class="n">fftshift</span><span class="p">(</span><span class="n">fft_image_raw</span><span class="p">)</span>
<span class="n">fft_abs_image_raw</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">fft_image_raw</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">crop_center</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="n">cent_size</span><span class="o">=</span><span class="mi">128</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">image</span><span class="p">[</span><span class="n">image</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">//</span><span class="mi">2</span> <span class="o">-</span> <span class="n">cent_size</span> <span class="o">//</span> <span class="mi">2</span><span class="p">:</span> <span class="n">image</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">//</span><span class="mi">2</span> <span class="o">+</span> <span class="n">cent_size</span> <span class="o">//</span> <span class="mi">2</span><span class="p">,</span>
                 <span class="n">image</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">//</span><span class="mi">2</span> <span class="o">-</span> <span class="n">cent_size</span> <span class="o">//</span> <span class="mi">2</span><span class="p">:</span> <span class="n">image</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">//</span><span class="mi">2</span> <span class="o">+</span> <span class="n">cent_size</span> <span class="o">//</span> <span class="mi">2</span><span class="p">]</span>


<span class="c1"># After the fftshift, the FFT looks right</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">ncols</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="k">for</span> <span class="n">axis</span><span class="p">,</span> <span class="n">img</span><span class="p">,</span> <span class="n">title</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">axes</span><span class="p">,</span> <span class="p">[</span><span class="n">fft_abs_image_raw</span><span class="p">,</span> <span class="n">crop_center</span><span class="p">(</span><span class="n">fft_abs_image_raw</span><span class="p">)],</span> <span class="p">[</span><span class="s1">&#39;FFT after fftshift-ing&#39;</span><span class="p">,</span>
                                                                                        <span class="s1">&#39;Zoomed view around origin&#39;</span><span class="p">]):</span>
    <span class="n">_</span> <span class="o">=</span> <span class="n">usid</span><span class="o">.</span><span class="n">plot_utils</span><span class="o">.</span><span class="n">plot_map</span><span class="p">(</span><span class="n">axis</span><span class="p">,</span> <span class="n">img</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">OrRd</span><span class="p">,</span> <span class="n">clim</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mf">1E+4</span><span class="p">])</span>
    <span class="n">axis</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">title</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
</pre></div>
</div>
<img alt="FFT after fftshift-ing, Zoomed view around origin" class="sphx-glr-single-img" src="../_images/sphx_glr_plot_fft_2d_filtering_004.png" />
<p>The first filter we want to make is a 2D, radially symmetric, low-pass Gaussian filter.
To start with, it is helpful to redefine the Fourier domain in polar coordinates to make
building the radially symmetric function easier.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">r</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">u_mat</span><span class="o">**</span><span class="mi">2</span><span class="o">+</span><span class="n">v_mat</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="c1"># convert cartesian coordinates to polar radius</span>
</pre></div>
</div>
<p>An expression for the filter is given below. Note, the width of the filter is defined in
terms of the real space dimensions for ease of use.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">filter_width</span> <span class="o">=</span> <span class="o">.</span><span class="mi">15</span>  <span class="c1"># inverse width of gaussian, units same as real space axes</span>
<span class="n">gauss_filter</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">e</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="p">(</span><span class="n">r</span><span class="o">*</span><span class="n">filter_width</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">ncols</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">_</span> <span class="o">=</span> <span class="n">usid</span><span class="o">.</span><span class="n">plot_utils</span><span class="o">.</span><span class="n">plot_map</span><span class="p">(</span><span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">gauss_filter</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">OrRd</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Gaussian filter&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">gauss_filter</span><span class="p">[</span><span class="n">gauss_filter</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">//</span><span class="mi">2</span><span class="p">])</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Cross section of filter&#39;</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
</pre></div>
</div>
<img alt="Gaussian filter, Cross section of filter" class="sphx-glr-single-img" src="../_images/sphx_glr_plot_fft_2d_filtering_005.png" />
<p>Application of the filter to the data in the Fourier domain is done simply by
dot-multiplying the two matrices.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">F_m1_filtered</span> <span class="o">=</span> <span class="n">gauss_filter</span> <span class="o">*</span> <span class="n">fft_image_raw</span>
</pre></div>
</div>
<p>To view the filtered data in the space domain, simply use the inverse fast Fourier transform
(‘ifft2’). Remember though that python expects low frequency components at the corners, so
it is necessary to use the inverse of the ‘fftshift’ command (‘ifftshift’) before performing
the inverse transform. Also, note that even though theoretically there should be no imaginary
components in the inverse transformed data (because we multiplied two matrices together that
were both symmetric about 0), some of the numerical manipulations create small round-off
errors that result in the inverse transformed data being complex (the imaginary component is
~1X1016  times smaller than the real part). In order to account for this, only the real part
of the result is kept.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">image_filtered</span> <span class="o">=</span> <span class="n">npf</span><span class="o">.</span><span class="n">ifft2</span><span class="p">(</span><span class="n">npf</span><span class="o">.</span><span class="n">ifftshift</span><span class="p">(</span><span class="n">F_m1_filtered</span><span class="p">))</span>
<span class="n">image_filtered</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">real</span><span class="p">(</span><span class="n">image_filtered</span><span class="p">)</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">ncols</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="k">for</span> <span class="n">axis</span><span class="p">,</span> <span class="n">img</span><span class="p">,</span> <span class="n">title</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">axes</span><span class="p">,</span> <span class="p">[</span><span class="n">image_raw</span><span class="p">,</span> <span class="n">image_filtered</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;original&#39;</span><span class="p">,</span> <span class="s1">&#39;filtered&#39;</span><span class="p">]):</span>
    <span class="n">_</span> <span class="o">=</span> <span class="n">usid</span><span class="o">.</span><span class="n">plot_utils</span><span class="o">.</span><span class="n">plot_map</span><span class="p">(</span><span class="n">axis</span><span class="p">,</span> <span class="n">img</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">inferno</span><span class="p">,</span>
                               <span class="n">x_vec</span><span class="o">=</span><span class="n">x_axis_vec</span><span class="p">,</span> <span class="n">y_vec</span><span class="o">=</span><span class="n">y_axis_vec</span><span class="p">,</span> <span class="n">num_ticks</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
    <span class="n">axis</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">title</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
</pre></div>
</div>
<img alt="original, filtered" class="sphx-glr-single-img" src="../_images/sphx_glr_plot_fft_2d_filtering_006.png" />
<p>Filtering can also be used to help flatten an image. To demonstrate this, let’s artificially
add a background to the original image, and later try to remove it.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">background_distortion</span> <span class="o">=</span> <span class="mf">0.2</span> <span class="o">*</span> <span class="p">(</span><span class="n">x_mat</span> <span class="o">+</span> <span class="n">y_mat</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">x_mat</span> <span class="o">/</span> <span class="n">x_edge_length</span><span class="p">))</span>
<span class="n">image_w_background</span> <span class="o">=</span> <span class="n">image_raw</span> <span class="o">+</span> <span class="n">background_distortion</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span> <span class="n">ncols</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="k">for</span> <span class="n">axis</span><span class="p">,</span> <span class="n">img</span><span class="p">,</span> <span class="n">title</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">axes</span><span class="p">,</span> <span class="p">[</span><span class="n">background_distortion</span><span class="p">,</span> <span class="n">image_w_background</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;background&#39;</span><span class="p">,</span> <span class="s1">&#39;image with background&#39;</span><span class="p">]):</span>
    <span class="n">_</span> <span class="o">=</span> <span class="n">usid</span><span class="o">.</span><span class="n">plot_utils</span><span class="o">.</span><span class="n">plot_map</span><span class="p">(</span><span class="n">axis</span><span class="p">,</span> <span class="n">img</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">inferno</span><span class="p">,</span>
                               <span class="n">x_vec</span><span class="o">=</span><span class="n">x_axis_vec</span><span class="p">,</span> <span class="n">y_vec</span><span class="o">=</span><span class="n">y_axis_vec</span><span class="p">,</span> <span class="n">num_ticks</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
    <span class="n">axis</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">title</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
</pre></div>
</div>
<img alt="background, image with background" class="sphx-glr-single-img" src="../_images/sphx_glr_plot_fft_2d_filtering_007.png" />
<p>Since large scale background distortions (such as tilting and bowing) are primarily low
frequency information. We can make a filter to get rid of the lowest frequency components.
Here we again use a radially symmetric 2D Gaussian, however in this case we invert it so
that it is zero at low frequencies and 1 at higher frequencies.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">filter_width</span> <span class="o">=</span> <span class="mi">2</span>  <span class="c1"># inverse width of gaussian, units same as real space axes</span>
<span class="n">inverse_gauss_filter</span> <span class="o">=</span> <span class="mi">1</span><span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">e</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="p">(</span><span class="n">r</span><span class="o">*</span><span class="n">filter_width</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">axis</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">_</span> <span class="o">=</span> <span class="n">usid</span><span class="o">.</span><span class="n">plot_utils</span><span class="o">.</span><span class="n">plot_map</span><span class="p">(</span><span class="n">axis</span><span class="p">,</span> <span class="n">inverse_gauss_filter</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">OrRd</span><span class="p">)</span>
<span class="n">axis</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;background filter&#39;</span><span class="p">)</span>
</pre></div>
</div>
<img alt="background filter" class="sphx-glr-single-img" src="../_images/sphx_glr_plot_fft_2d_filtering_008.png" />
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>Text(0.5, 1.0, &#39;background filter&#39;)
</pre></div>
</div>
<p>Let’s perform the same process of taking the FFT of the image, multiplying with the filter
and taking the inverse Fourier transform of the image to get the filtered image.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># take the fft of the image</span>
<span class="n">fft_image_w_background</span> <span class="o">=</span> <span class="n">npf</span><span class="o">.</span><span class="n">fftshift</span><span class="p">(</span><span class="n">npf</span><span class="o">.</span><span class="n">fft2</span><span class="p">(</span><span class="n">image_w_background</span><span class="p">))</span>
<span class="n">fft_abs_image_background</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">fft_image_w_background</span><span class="p">)</span>

<span class="c1"># apply the filter</span>
<span class="n">fft_image_corrected</span> <span class="o">=</span> <span class="n">fft_image_w_background</span> <span class="o">*</span> <span class="n">inverse_gauss_filter</span>

<span class="c1"># perform the inverse fourier transform on the filtered data</span>
<span class="n">image_corrected</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">real</span><span class="p">(</span><span class="n">npf</span><span class="o">.</span><span class="n">ifft2</span><span class="p">(</span><span class="n">npf</span><span class="o">.</span><span class="n">ifftshift</span><span class="p">(</span><span class="n">fft_image_corrected</span><span class="p">)))</span>

<span class="c1"># find what was removed from the image by filtering</span>
<span class="n">filtered_background</span> <span class="o">=</span> <span class="n">image_w_background</span> <span class="o">-</span> <span class="n">image_corrected</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">ncols</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="k">for</span> <span class="n">axis</span><span class="p">,</span> <span class="n">img</span><span class="p">,</span> <span class="n">title</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">axes</span><span class="p">,</span> <span class="p">[</span><span class="n">image_corrected</span><span class="p">,</span> <span class="n">filtered_background</span><span class="p">],</span>
                            <span class="p">[</span><span class="s1">&#39;image with background subtracted&#39;</span><span class="p">,</span>
                             <span class="s1">&#39;background component that was removed&#39;</span><span class="p">]):</span>
    <span class="n">_</span> <span class="o">=</span> <span class="n">usid</span><span class="o">.</span><span class="n">plot_utils</span><span class="o">.</span><span class="n">plot_map</span><span class="p">(</span><span class="n">axis</span><span class="p">,</span> <span class="n">img</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">inferno</span><span class="p">,</span>
                               <span class="n">x_vec</span><span class="o">=</span><span class="n">x_axis_vec</span><span class="p">,</span> <span class="n">y_vec</span><span class="o">=</span><span class="n">y_axis_vec</span><span class="p">,</span> <span class="n">num_ticks</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
    <span class="n">axis</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">title</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
</pre></div>
</div>
<img alt="image with background subtracted, background component that was removed" class="sphx-glr-single-img" src="../_images/sphx_glr_plot_fft_2d_filtering_009.png" />
<p>delete the temporarily downloaded file:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">h5_f</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
<span class="n">os</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">h5_path</span><span class="p">)</span>
</pre></div>
</div>
<p class="sphx-glr-timing"><strong>Total running time of the script:</strong> ( 0 minutes  6.584 seconds)</p>
<div class="sphx-glr-footer class sphx-glr-footer-example docutils container" id="sphx-glr-download-auto-examples-plot-fft-2d-filtering-py">
<div class="sphx-glr-download sphx-glr-download-python docutils container">
<p><a class="reference download internal" download="" href="../_downloads/1b435e4f022b91269053ebace9748851/plot_fft_2d_filtering.py"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Python</span> <span class="pre">source</span> <span class="pre">code:</span> <span class="pre">plot_fft_2d_filtering.py</span></code></a></p>
</div>
<div class="sphx-glr-download sphx-glr-download-jupyter docutils container">
<p><a class="reference download internal" download="" href="../_downloads/5923f2e324daab8047fbef2e4f9867ac/plot_fft_2d_filtering.ipynb"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Jupyter</span> <span class="pre">notebook:</span> <span class="pre">plot_fft_2d_filtering.ipynb</span></code></a></p>
</div>
</div>
<p class="sphx-glr-signature"><a class="reference external" href="https://sphinx-gallery.github.io">Gallery generated by Sphinx-Gallery</a></p>
</div>


           </div>
           
          </div>
          <footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
        <a href="plot_image_registration.html" class="btn btn-neutral float-right" title="Image alignment and registration" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
        <a href="index.html" class="btn btn-neutral float-left" title="Examples &amp; Tutorials" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright 2016, Suhas Somnath, Chris Smith, Stephen Jesse, Numan Laanait.

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>